# -*- coding: utf-8 -*-
"""
Created on Mon Jun  5 11:19:18 2023

@author: Dan
"""

# from data_functions_common import cal_lookup, loc_lookup, parse_prod_request, parse_loc_request, prod_hier
# from data_config import data_url, chain_id, global_zone_id
# import requests
# import pandas as pd
# import numpy as np
# import os as os
# import time
# import re

from affinity.affinity_data_functions_common import cal_lookup, loc_lookup, parse_prod_request, parse_loc_request, prod_hier
from affinity.affinity_data_config import data_url, chain_id, global_zone_id,username,password,dbname,is_db
from rapidfuzz.process import extractOne
from rapidfuzz.fuzz import QRatio
import requests
import pandas as pd
import numpy as np
import os as os
import time
import cx_Oracle
import re

def is_number(input_str):
    return re.match(r'^-?\d+(?:\.\d+)?$', input_str) is not None

def clean_name(name):
    if not pd.isna(name):
        return re.sub(r'\s+', ' ', name).lower()
    else:
        return name
    
def affinity_api(product_name = None,user_id = None):
    
    # item_list = None, active = 'Y',
    #              location_name = None, location_id = None, location_level = None,
    #              cal_year = None, quarter = None, period = None, week = None, day = None,
    #              start_date = None, end_date = None, calendar_id = None, cal_type = 'W',
    #              promoted = 'All',
                 
    # if (cal_year is None and quarter is None and period is None and week is None and day is None
    #     and start_date is None and end_date is None and calendar_id is None):
    #     quarter = 'current'
        
    # if cal_year is None and (quarter is not None or period is not None or week is not None or day is not None):
    #     cal_year = 'current'
        
    # cal = cal_lookup(cal_year, quarter, period, week, day,
    #                  start_date, end_date, calendar_id, cal_type)
    
    # if location_name is None and location_id is None and location_level is None:
    #     loc = {6: [121]}
    #     loc_names = ['ONLINE STORE']
    # else:    
    #     loc, loc_names = parse_loc_request(location_name, location_id, location_level)[:2]        
    
    # products = parse_prod_request(product_name, product_id, product_level,
    #                             user_id, 'Y')
    
    # prod_names = list(products['product-name'])
    # #prod_ids = list(products['product-id'])
    # prods = {p:[int(x) for x in products.loc[products['product-level'] == p, 'product-id']] for p in products['product-level'].unique()}
    
    #responses = ['ICE CREAM DOUBLE DIP','ICE CREAM COLOSSAL DIP','ICE CREAM TRIPLE DIP','ICE CREAM PINT']
    
       
    
    data = pd.read_csv("E:/Development/iux/presto-iux/iux-backend/main/affinity/FFSynU.csv")
    
    # names_list = ['BANANA-YELLOW--','F-BYET SHRED CHSE 8OZ 63','F-FRISKIES MEATY BITS 5.5Z 12','CHICKEN BNLS SKINLESS BREAST','F-BARILLA PASTA 99','GRND BEEF 80% LEAN 20% BP','F-CABOT BARS 8OZ 135','PEPPERS GREEN MED/LG','F-FANCY FEAST 3OZ 242','BYET GRADE A LARGE WHITE','CUCUMBER S/S','TOMATO HOT HOUSE','F-FAMILY GROUP 1341','F-CHOBANI GREEK 5.3OZ','F-BYET BUTTER 16OZ 242','TOMATOES CLUSTER ON THE VINE','F-COFFEEMATE 32FO 497','ITALIAN BREAD (PAPER)','F-RONZONI PASTA 480','P5 BEEF GROUND 80% LEAN','BROCCOLI CROWNS ASIAN','F-BYET ICE CREAM 48FO 94','FRESH PICK 5 BASILIO BUDA FRSH SAUSA','F-INTERNATIONAL DELIGHT CREAMERS','FREIHOFER WHITE ITALIANO BREAD','FRESH GROUND BEEF 80% LEAN 20% FAT R','YELLOW CORN 48CT','F-KNORR PSTA/RCE SCE 82','BEST YET ROUND TOP WHT BREAD','WATERMELON RED SEEDLESS','ONIONS SWEET','AVOCADO HASS GREEN 40','F-SUGARDALE 1LB BACON 7000','F-HELLMANNS MAYO 30FO','F-STFR DINNERS 251','FRESH GROUND BEEF 85% LEAN 15% FAT','F-HELAVA GOOD DIP 1403','LETTUCE ICEBERG','F-CABOT SHREDS 8OZ 208','BYET GRADE A LGE WHT 18PK','LEMONS CALIF. FANCY 95CT','F-CAMPBLL SOUPS 591','F-Family Group 1737','BEST YET 1% MILK','F-Family Group 1475','ONIONS RED JUMBO 25LB BULK','CHICKEN THIGHS BIG PACK','FREIH PREM SRDOUGH ITAL BREAD','F-BYET BAR CHEESE 8OZ 64','F-HOOD ICE CREAM  48FO 22','F-CABOT BUTTER QTRS 752','F-SARGENTO SHRED 8OZ  53','F-MCCAIN FRIED POTATOES 231','F-RESERS POTATOES','F-PREGO PASTA SAUCE 260','RED GRAPE BAG 1.5 LB','ASPARAGUS 94390','F-B YET DRESSINGS 16FO','F-LUNCHABLES 59','TOMATO ROMA SFM','F-BANQUET DINNERS 1248','BAG PREM RUSSETS 5LB','F-FAMILY GROUP 1342','F-LOL BUTTER 16OZ 241','SHELF DUMMY CARDBOARD WHITE','PEPSI COLA 6PK/16.9OZ','F-CHOBANI YGRT 5.3OZ 1017','BEST YET HAMBURGER ROLL 8PK','F- 14 BOB EVANS SIDES 6935','PURPLE SUPER COLSL GARLIC 30LB','IDAHO POTATO 80 CT','F-BYET FRZ VEGS STEAMABLE 12Z 311','F-BYET CRM CHS BAR 8OZ 981','GROUND BEEF 90% LEAN 10% FAT','CABBAGE GREEN','GRND BEEF 85% LEAN 15% FAT BP','PEPPERS RED','F-HELUVA GOOD CHSE STICK 1404','F-Family Group 278','BEST YET HOT DOG ROLL 8PK','F-CHEF BOY RD CANNED MEALS 330','F-BIRDSEYE VEGS 10Z 263','F-OLD EL PASO SEASONING 1Z 424','F-KENS SALAD DRESSING 16OZ 13','PEPSI 20OZ BOTTLE','CUCUMBER HYDRO','F-IDAHO POTATOS DRIED 4Z 635','B YET GRANULATED SUGAR','F-BC HAM HLPR 34','F-COFFEEMATE CREAMER 64FO 6840','LARGE SUB - MADE TO ORDER','CHICKEN DRUMSTICKS','F-HUNTS PASTA SAUCES 24OZ 106','P5 PORK BONELESS PORK CHOPS','F-OM LUNCHABLES','F-14 OM BACON 1LB 6934','PEPSI 2 LITER','F-PROG SOUPS 19Z 35','MOUNTAIN DEW 20Z BOTTLE','F-FLORIDA NAT JUICE 65','LAYS XL CLASSIC CHIPS','BALL PARK HAMBURG BUNS','NF 5 LB WHT','25 LB MED GREEN SQUASH','F-COOL WHIP TOPPINGS 8OZ 92','F-DANNON L&F GRK YGT 5.3OZ 1031','F-RAGU SAUCES 6','F-Family Group 27','ONIONS VIDALIA JUMBO','F-JELLO INSTNT PUDDINGS 130','F-PHILLY CRM CHSE BRCK 8Z 792','F-HF LUNCH MEAT 173','F-Family Group 152','SMITHFIELD COOKED HAM','COKE 20 OZ PLASTIC BTLE','SHP 5# WHITE POT GG','F-Family Group 24','F-Family Group 1349','MT DEW 6PK/16.9OZ','MELON CANTALOUPE JUMBO 9 CT','F-BYET FROZEN VEGS 16Z 209','F-Family Group 161','F-BYET BEANS CANNED 860','BEST YET ITALIAN BREAD','F-Hershey King size bars','NS CHERUBS TOMATO 10 OZ','LAYS WAVY ORIGINAL','P5 BONELESS CHICKEN BREAST','F-DAISY SOUR CREAM 16oz 6882','F-CABOT SLICES 1299','F-PRINCE PASTA 224','ORANGE NAVEL','BALL PARK HOT DOG BUNS','NF 5 LB RED','F-BYET SOUR CREAM 16OZ 988','SMITHFIELD VIRGINIA HAM','DITALIANO PLAIN BREAD','F-CAMP TOM-CHKN NOODLE SP 10.75Z 584','F-NESTLE MILK 14FO  582','XXL DORITOS NACHO CHEESE','F-PHILLY CRM CHS 8OZ 205','ONIONS WHITE JUMBO','F-Family Group 1035','LAYS PARTY WAVY','NW CHERRY 11 R','F-HERSHEY SYRUP 22-24Z 202','SARA LEE ARTESANO STYLE BREAD','SARA LEE CLASSIC BUTTER BREAD','NF 5 LB GOLD','F-RICE A RONI 101','DIET PEPSI 6PK','F-Family Group 1526','F-HAW PUNCH DRINK 128FO 304','F-JELLO GELATIN 3OZ 79','F-Family Group 1382','F-MARUCHN NOODLES 3Z 54','F-BYET COTT CHSE 16OZ','F-KEEBLER TOLLHOUSE','F-14 BYET GRATED CHS 8OZ 6548','BYET GRADE A X-LARGE WHIT','GRL 2% MILK','F-BE FROZEN VEGETABLES','TOMATOES GRAPE PINTS','DAISY SQZ SOUR CREAM','F-CESAR DOG WET 3.5Z 511','F-PETER PAN P-BTTR 16.3Z 148','F-BYET CHEESE CHUNK 16Z 973','BF CHCK ROAST BNLS USDA CHOICE','F-BYET PREM OJ 59FO 2466','F-BUSH''S BEANS 2326','F-STOVE TOP STUFFG 6OZ 77','F-POST PEBBLES CEREAL 11Z 292','THOMAS EVERTHING BAGEL','MINI CUCUMBER','F-V8 SPLASH 64FO 105','BH OVEN GOLD TURKEY BREAST','F-BYET TOMATOES CANNED 14.5Z 331','DR PEPPER 20 OZ','F-BYET VEGS CANNED 51','CHOCLATE CHIP COOKIES 12 CT','F-HUNGRY MAN DINNER 16Z 279','F-PILLS GRAND BISCUIT 16.3OZ 2256','WONDER CLASSIC WHITE ROUND TOP','BYET HALFHALF','BYET GRADE A MEDIUM WHITE','F-MARY CAL ENTREES 27','CHICKEN WINGS','F-HEINZ GRAVY 12OZ 83','F-GERB 2ND FDS 2PK 8OZ 154','F-CRYTSAL FARMS SHRED 8OZ1294','F-PROG CLASSIC HRTY SOUP 24','ONION VALU-PAK GOURMET 3# SS','F-BYET HALF&HALF 16FO 963','F-PILLS TOASTER STRUDEL 56','F-DOLE PINEAPPLE 20Z 2293','F-Family Group 60','F-Family Group 1517','F-BYET COT CHSE 24OZ','LETTUCE ICEBERG EASTERN','SARA LEE HONEY WHEAT','BYET HVY CREAM GRD A ULT PAST','NAVEL ORNGE CALIF 4LB-D','MT DEW 2 LITER','F-Family Group 565','F-MOTTS JUICE 64FO 276','PEPSI 12PK FRIDGE','UTZ RIPPLE CHIP','F-PRINCE PASTA 235','PEPPERS JALAPENO','F-Family Group 1537','F-CHOBANI YOG 32OZ 771','F-OSCR MYR DL LUNCH MT 2','F-B YET YOGURT 6OZ  968','SPRITE 20 OZ BOTTLE','F-Best Yet Cheese Slices 12oz','CHICKEN BREAST CUTLETS THIN SLICED','F-BYET SHRED CHEESE 32OZ','DOM GRANULATED SUGAR 4LB','F-NESTLE DGN CRSP PIZZA','F-Table Talk Pies - Bkry','DIET PEPSI 2LTR','F-DANNON OIKOS 5.3OZ 657','F-PROGRESSO R&H SOUPS 103','DIET PEPSI 20OZ','P5 BEEF ROUND CUBE STEAKS','F-Family Group 1028','WONDER HAMBURGER ROLLS 8CT','BLUEBERRIES','F-FLGR GRND CFE CN','SAUSAGE ITALIAN HOT GIANELLI','F-Family Group 1175','F-NESTLE MORSELS 2283','F-Family group 5831','ENT SOFTEE VAR DONUT','ITALIAN BREAD (SLICED)','ANZIO HOAGIE ROLLS 6CT','F-MARIE CALLENDERS BOWLS','F-BYET GRAVIES PACKETS 895','F-DH BROWNIE MIX 213','BYET GRADE A JUMBO WHITE','SARA LEE CLASSIC WHEAT BREAD','PEPSI CUBE','ONIONS YELLOW 2LB BAG','F-JIF PNUT  BUTTER 16Z 204','F-GM CHEX CEREAL 2327','AQUAFINA 20 OZ BOTTLE','F-STNYFLD YOGURT 32OZ 770','F-WEIGHT WTCHRS SMRT ONE 294','BEST YET SKIM MILK','F-SWEET BABY RAY BBQ 396','PROD KNF 6 SANI SF HNDL S186','TOSTITOS SCOOPS FSZ','F-KELLOGG POP TARTS 20.3Z 7','F-OCEAN SPRAY CRAN SAUCE 14Z 413','F-HUNTS TOMATOES 14.5Z 634','F-Family group 5920','F-HERSHEY SNACK SIZE','COKE CLASSIC CONTOUR 2 LTR','BROCCOLI CROWNS 94299','F-Adirondack 2Lt Soda','LETTUCE GREEN LEAF CALIF','F-CABOT CHSE BRICK 32Z 787','F-BYET SODA SELTZER 12PK 319','F-HOOD COTT CHEESE 24OZ 761','F-STFR DINNERS 252','BEEF CUBE STEAK USDA CHOICE','F-HEALTHY CHC CAFE STMR 690','F-Family Group 831','F-BC COOKIE MIXES 68','F-ORTEGA TACO SAUCE 8Z 172','BALL PARK NEW ENGLAND FRANKS','F-ICBINB MARG 15OZ 736','F-LA YOGURT 6OZ 127','F-Family Group 1996','F-PREMIO SAUSAGE  16OZ','COKE CLASSIC FRIG PK','B YET APPLE JUICE 100%','APPLE GRANNYSMITH 80CT','LAYS XL SALT  VINEGAR CHIPS','F-FRESH EXPRESS LETTUCE 11 OZ - PROD','F-KRAFT CHS SINGLES 16OZ 150','F-TROP OJ 89FO 312','F-JELLO PUDDING PACKS 997','KAISER ROLLS-LARGE 6 PACK','F-KELL CEREAL LARGE 1414','BP HD MEAT FRANK BUN SIZE 8CT','F-Family group 5917','HOOD HEAVY CREAM','OATMEAL COOKIES 12 CT','F-CABOT 32 OZ  YOGURT','CHICKENS WHOLE','F-BIRDSEYE FRZ VEGS 255','CANADA DRY GINGER ALE 20 Z','F-Family Group 946','CANDY COOKIES 12 CT','RED BELL PEPPER 15 LBS','F-SUNNY D BLEND 64FO 1252','F-Family group 5877','HNZ TOMATO KETCHUP','ICEBURG LETTUCE-24CT -D','WONDER HOT DOG ROLLS 8CT','COUNTRY STYLE RIBS BP','F-STFR LEAN CUS ENTREES 334','F-BYET WHIP TOPPING FRZ 8Z 210','COKE CLASSIC 6 PK 500 ML BTTL','F-Family Group 1519','F-HF TRKY SLCED 1273','ANZIO KAISER ROLLS 8CT','HLVA GD DIP FRENCH ONION','F-HOOD SOUR CREAM 16 725','F-Family Group 864','MUSHROOM BABY BELLA SLICED','F-DELMONTE FRUIT 30','F-BYET SLICE CHSE SHNGL 976','ITAL ASST ON WHITE LRG SUB','F-Family Group 1545','THOMAS CINN/RAISIN ENG MUFFIN','BP HD  MEAT FRANKS 8CT','MOUNTAIN DEW FRIDGE PK','F-HUNTS MANWICH 15Z 526','F-NATHANS FRANKS 12OZ 1368','HANS PKL CHIPS 1/2" STRGHT CUT|640|OZ|1||||004242100798|||00042421007985|||||||||||||-','GROUND BEEF 90% LEAN 10% FBP','TURKEY  PROV - WHITE LRG SUB','LAYS XL SOUR CREAM  ONION','DASANI WATER 20OZ LOOSE','P5 PORK BNLS CNTRY STYLE RIB','F-FRISKIES PARTY MIX 2.1z 488','G&G WUNDERBAR BOLOGNA','F-B YET SOFT CRM CHEESE 8oz 2005','F-MAXWELL HOUSE LARGE CAN 115','BF LONDON BROIL USDA CHOICE','F-T/O CRAB CLSSC 8Z 835077','SARA LEE CLASSIC WHITE BREAD','RESCUED RIPE BANANAS','P5 BEEF ROUND CUBES FOR STEW','F-DAISY SOUR CREAM 8oz 5797','BAR S BACON HARDWOOD SMKD','P5 BEEF GROUND PATTY 80% LN','HLVA GD FRNCH ONION DIP','CAULIFLOWER CELLO 12CT','F-HAGAN DAZS ICE CREAM 14 FLZ','XXL DORITOS COOL RANCH','PSZ DORITOS COOL RANCH','LD SWISS CAKE ROLLS','F-BYET FRUIT CANNED 15OZ 115','F-GORTONS FISH 707','THOMAS NY ONION BAGEL','F-MCK SEASONING MIX-CHILI 602','F-MCCALL FRZN VEG POT PIE 341','F-MARS CANDY FUN SZ 1438','F-PANERA 16OZ SOUP','F-HOOD HALF&HALF 32oz 6438','PORK LOIN CHOPS CENTER CUT BONE IN','SCOTT 1000 WHT TP SINGLE RL','RBY 3 1 PTTY 1 33 NT 12 PK','CANADA DRY GINGER ALE 2 LTR','F-PEDIGREE DOG 13.2Z 60','HAM  SWISS ON WHITE LRG SUB','F-Family group 5799','F-BARILLA LARGE PASTA 482','F-BTTY CRCKR FRSTNG 187','BEST YET SPLIT WHEAT BREAD','F-DOM BROWN_CONF 32Z BAGS 622','F-HERSHEY BAKING CHIPS 87','BYET GRADE A LG BROWN','UTZ REGULAR CHIP','F-BANQUET POT PIES 7Z 168','F-PLANET OAT DRINKS 52 FO','F-Family Group 1462','F-Family Group 1207','F-Family Group 1459','F-BCHNT STG2 BBY FD 4Z 1355','F-BENEFUL DOG FD WET 10Z 156','F-PILLS RTB COOKIES 2276','BEEF CHUCK FOR STEW USDA CHOICE','PILLS PIE CRSTS 2CT','F-LIPTIN RCP SOUP MIXES 594','F-Family Group 744','F-DUNCAN DNT CRMR 32FO 1119','MONSTER ENERGY 16OZ LOOSE','THOMAS NY CIN/RAIS BAGEL','CAMPARI SUNSET LABEL ONLY','80% GR BEEF PATTY 1 LB 12 PK','F-Family Group 1478','BEEF SHOULDER LONDON BROIL BNLS USDA','COKE ZERO 20OZ LOOSE','CORNERSHOP AMERICAN WHITE','SCHWEPPES 2 LTR GINGER ALE','F-NESTLE COOKIES 16.5OZ 189','F-INTER DLGHT CRMR 64FO 1196','MOUNTAIN DEW CUBE','MUSHROOM SLICED 10OZ','F-DELMONTE VEGS CANNED 179','F-STARKIST CHUNK LT TUNA 5Z 403','TS PAPER TOWEL','TOSTITOS CON QUESO DIP','SMALL SUB TURKEY  PROVOLONE','F-Family group 6051','F-FR RINALDI SAUCES 69','F-OCEAN SPRY CRAN JCE 101FO 457','B YET SOUR CREAM','F-SHAKE N BAKE COATING MIX 3061','F-ONCOR MEALS FAMILY SZ 28Z 694','LETTUCE ROMAINE HRTS','F-STFR CLASSICS 10-12Z 669','F-OSCAR MEYER FNKS 16Z 4633','F-CAMPBLL FAMILY SZ 22.6Z 587','PEANUT BUTTER COOKIES 12 CT','LAYS XL LIGHTLY SALTED CHIPS','F-TOTINO PIZZA ROLLS 50CT','F-YOCRUNCH YGRT 6OZ 216','F-DUNCAN HINES FROSTING 5','F-DOLE 100% JC 59FO 2270','BLU BNNT SPRD STK VEG OIL','PEAR BARTLETT 90 CT','F-KELL MINI WHEATS 315','F-PASTA RONI 102','F-JELLO PACKS 996','F-Family Group 499','P5 BONELESS CHICKEN TENDERS','BEVAN FP MASHED POTATOES','UTZ SOUR CREAM ONION RIPPLE','F-Family Group 1984','SUGARDALE SLCD PEPP','THOMAS WHITE ENG MUFFIN W/WHGR','F-B YET RICOTTA 15OZ 978','F-RAGU SAUCE 45Z 117','F-CEDARS HUMMUS 8OZ 105578','F-Family Group 633','SCHWEPPES GINGER ALE 6PK/16.9Z','CHICKEN THIGHS BNLS SKNLS LF','F-PHILLY CRM CHS 12OZ 793','F-QUAKER LIFE CEREAL 13Z 291','F-Family group 6835','F-FRSKS CAT FOOD 5.50OZ','F-BAR S FRANKS 16Z 6174','F-COLLEGE INN BROTH 32FO 588','F-BYET FLOUR 5LB 287','BEST YET SANDWICH BREAD','F-KRFT DLX CHSE SLICES 16Z 785','F-Family Group 1513','F-MCK TACO SEASON MIX','BRUSSEL SPROUTS 25LB BULK','F-CCO DOG TREATS 4.50OZ','F-INTRNTL DLGHT 48FO 6302','EGLND EGGS','F-PILLSBURY CAKE MIX 1256','F-MXWLL HOUSE GRND COFFEE CAN 166','F-COS CHUNK LIGHT TUNA 5Z 402','LAYS XL BBQ CHIPS','P5 BEEF STRIPS FOR STIR FRY','AVOCADO 48 CT PERUVIAN','EGLND EGGS EXTRA LG','BEEF ROUND CUBES USDA CHOICE','GRINDER ROLLS 6 PACK','SEEDLESS WATERMELON SLICE','SHALLOTS','F-Family Group 2215','F-Family Group 47','CBT CREAM CHEESE','F-WISHBONE DRESSING 8Z 14','THOMAS C/R BRKFST','F-Family Group 307','F-PILLS CINN ROLLS 314','F-DH SIGNATURE CAKE MIX 352','XXL DORITOS SWT CHILI  SR CRM','F-ONCOR FAMILY MEALS 26Z 693','F-BYET YOGURT 32OZ 969','F-Family Group 1586','PERRI SWEET LINKS 13101','STRAWBERRIES DRISCOLL-1 LB','F-SHED CNTRY CRCK 15OZ 732','TRUMOO WHOLE CHOCOLATE 1/2 GAL','F-TROP DRINKS 59FO 1197','F-Tai Pei Chicken','F-MM JUICE 59FO 745','80% ANG GR BF PATTY 1.33 LB','HTFLD HAM STEAK','PSZ RUFFLES REGULAR CHIPS','F-COS SOLID WHITE TUNA WTR 300','F-BYET INSNT OATMEAL 119','BEST YET 1893 ROASTED TURKEY','NATURES OWN HNY WHT BREAD','F-CHOB GREEK YOGURT 5.3OZ','F-Family group 6144','F-MT OLIVES PEPPERS 12Z 599','F-MRCHN RAMEN 12PKS 36Z 598','CHICKEN LEG','SUGAR COOKIES 12 CT','F-Family group 6369','F-Family group 6366','PEPSI MAX 16.9 OZ 6PK','F-BYET SHRED CHEESE 16OZ','F-TGIF FRZ APTZRS 322','SPRITE CONTOUR 2 LTR','P5 BEEF SHOULDER STEAK','BH SLICE HONEY MAPLE HAM','F-Family group 5999','F-NESTLE DGN PIZZA','F-JOHNSONVILLE BRATS 1006','F-BC SUPERMOIST CAKE MIXES 4','F-Family Group 577','ENT SOFTEE ASST W/FRST DONUT','PLNVL FRM NAT GRND TRKY 85','F-Family group 6279','F-BYET SEASONING MIXES 941','SPB DESSRT SHLL 6PK','F-Family Group 1648','F-Family Group 1836','P5 BEEF GROUND 85% LEAN','SQUASH BUTTERNUT CUT  PEELED','F-MRCHN RAMEN 6PK 18Z 595','PEPSI WILD CHERRY 6PK/16.9OZ','F-MCCORMICK GRAVY MIX 343','F-BYET STUFFING MIXES 6OZ 113','DIET COKE 6PK 500 ML BOTTLES','BELG PARMESIAN SHRED CUP','EGGPLANT 24S','NATURES OWN BUTTER TOP BREAD','F-Family group 6544','UTZ HONEY BBQ CHIP','WONDER ITALIAN LOAF','F-PHILLY CRM CHS WHIP 8OZ 206','WATERMELON MINI','BRYNE HALF  HALF','F-PILLSBURY FROSTING','F-LINDYS ITALIAN ICE 6PK 36Z 278','F-BYET GRAHAM CRACKERS 14.4OZ 2425','P5 CHICKEN THIGHS','PINECHUNKS DEL 2/ 5#','HAM STEAK','F-CHOBANI DRINKS 7 FLZ 96167','SARA LEE ARTESANO BUNS','BCKR SIGNATURE TUSCAN LOAF','B YET SINGLE SAS TOWEL 116CT','BCKR SOURDOUGH','SANTITAS WHITE CORN','1 LITER BTL PEPSI COLA','LAYS WAVY LIGHTLY SALTED','F-Family group 5948','MONSTER ZERO ULTRA 16 OZ','BH DELUXE HAM','F-CAMPBELL SPAGHO 15.8Z 261','BF TOP RND STK BNLS USDA CHOIC','F-BYET PINEAPPLE 20OZ 884','CANADA DRY GINGERALE .5LTR/6PK','SARA LEE 100% WHOLE WHEAT','SARA LEE SS WHLE GRAIN WHITE','HF HAMPTON ROASTED PEANUTS','F-GLBNI RICOTTA 15OZ 5744','F-BYET CHOC BAKING CHIPS 856','NATURES OWN 100% WHOLE WHT BRD','NAB WHEAT THINS ORIGINAL 8.5','NABISCO HONEY MAID HONEY GRAHA','F-DAISY SOUR CREAM 24 726','NAB TRISCUIT ORIG','F-FRISKIES DRY 3LB 495','TONYS PIZZERIA PEPPERONI','BF TOP SIRLOIN STK BNLS BP CHOIC','SMALL SUB ITALIAN ASSTORTED','CD GINGER ALE FRIG PK','F-LAWRY MARINADE 12FO 397','ONIONS YELLOW LG/ BULK','F-Family Group 1481','F-OSCR MYR FRANKS 6933','POPCORN BREAST CHUNKS','MANGOS LARGE 9CT (K)','F-MORTON SALT 26Z 626','F-TUTTUROSO TOM 28Z 637','P5 BEEF TOP ROUND STEAK','F-DAMIMALS 6PK 233','MUG ROOT BEER 6PK/16.9','HNZ TOMATO KETCHUP SQUEEZE','JERSY FRESH YELLOW SQUASH','P5 BEEF SIRLOIN TIP STEAK','FRANKS ORIG RED HOT SAUCE','DIET COKE FRIG PK','F-NO YOLKS NOODLES 12Z 481','F-GOLD MEDAL FLOUR 5LB 288','F-PILLS CLASSIC BROWNIES 1390','F-YPLT GOGURT 16OZ 1418','F-PILLS QUICK BREADS 1324','BRYNE HEAVY CREAM 36%','PFARMS 8 FRANK ROLL TOP SLICES','PORK RIB CHOPS BONE-IN','COKE CLASSIC 1.25LTR','F-Family group 6188','CHOC CARAMEL NUT SNICKERS JMBO','F-STOK COLD BREW','F-TIDE SIMPLY','F-BYET CRM CHS 8OZ 207','NS GLORY TOMATO','MARTIN POTATO SANDWICH','ARNOLD HEALTHY MULTI GRAIN','HOFMANN  GERMAN FRANKS','F-VANDEKAMP FISH 705','F-OUTSHINE FRUIT BARS 12CT','GIANELLI SWEET SAUSAGE PATTY','F-SABRA HUMMUS 347','SMALL FRUIT CUP STRAWBERRY','SMALL SUB HAM  SWISS','NAB OREO DOUBLE STUF','F-TEDDIE O.F. P-BUTTER 16Z 437','P5 BEEF CHUCK CUBES FOR STEW','F-MEOW MIX DRY 3LB 496','F-Family Group 1938','SGRDLE 1LB HOT DOGS','F-BANQUET CHICKEN FAMILY SZ 699','BEST YET 1893 WHITE AMERICAN','ECONOMY CUT T-BONE','F-TWININGS TEA 20CT','LAYS REGULAR','DIET COKE CONTOUR 2 LTR','F-KRFT VELVTA SINGLES 12OZ 6941','F-TINA BURRITOS 4Z 326','B YET FACIAL TISSUE','WENN PIZZA DOUGH PREBAGD','F-MCMK BEEF STEW SEASON MIX','BEEF STRIP STK SEMI BNLS BIG PACK US','KINDR BUENO','SMALL SUB MADE TO ORDER','ENT GLAZED POPEMS','ANGEL SWEET TOMATO 1PT','TONYS PIZZERIA CHEESE','F-BYET TOASTER PSTRY 11Z 109','PF SANDWICH BUNS','F-GERB GRAD/PUFFS 1.48Z 2322','F-CARNATION EVAP MILK 12Z 306','DR PEPPER 2 LTR','F-SMUCKERS TOPPINGS 11-12Z 642','F-BYET JUMBO BISCUITS 16OZ 980','F-FANCT FST CAT WET 3Z 178','LAYS XL DILL PICKLE CHIPS','F-JELLO INST PUDDING 420','PF HAMBURGER BUNS','RYE DIP WITH CHIPPED BEEF','F-MCK SPICE CLASSIS SPICES 603','DIET PEPSI 12PK','SMALL FRUIT CUP WATERMELON','F-TURKEY HILL 48OZ ICE CREAM','P5 BEEF EYE ROUND STEAK','FM KIWI','93% GROUND ROUND 1 LB 12 PK','GRAPES BLACK SEEDLESS','F-CRYSTAL FARMS CHUNK 1345','DR PEPPER 6PK/16.9OZ','F-Family Group 1445','F-BNUT STG2 BABY FD 4Z 47','F-FNCY FST PTTE CAT FOOD 2.8OZ','MARG PEPPERONI CRACKER CUT','F-JDEAN SAUS ROLL 16Z  6265','FRENCH BREAD (PAPER)','F-BYET FRZN WAFFLES 62','CAVENDISH HSHBR PATTIES','1 LITER BTL MOUNTAIN DEW','HOFMANN  GERMAN FRANKS SKNLSS','HTFLD HONEY HAM STEAK','P5 BEEF BONELESS CHUCK STEAK','BYET GRADE A XLG BROWN','F-G&G CUPCAKES BAKERY 3745','F-BYET RICOTTA 32OZ 977','F-BADIA SPICES 8PK','DIET PEPSI MAX 20OZ LOOSE','F-OLD EL PASO SHREDS 3062','F-BC TRDTL BROWNIE MIX 290','NATTY DADDY 25OZ CAN','SPRITE FRIG PACK','ACORN SQUASH','MT DEW DIET 6PK/16.9OZ','F-KNORR SCE GRVY MIX','F-Chatham Croutons 5oz 96184','F-NEWMAN DRESSING 16FO 18','F-Family group 6062','GREENS KALE','REESES PB COOKIE JUMBO','CRUSH 6PK','F-CABOT SOUR CREAM 16OZ','F-Family group 5815','LITTLE POTATO DYNAMIC DUO','CLUB ROLLS 6 PACK','POWERADE MOUNTAIN BLAST','F-Family group 6141','CORNERSHOP RSTD TURKEY BRST','F-BORDEN SHREDS 8OZ 778','IMP SPRD VGTBL OIL','F-FAMILY GROUP 6401','F-KELL FROSTED FLAKES 1221','BH SLICE OVENGOLD TURKEY','C/F DIET PEPSI 6PK','BRDGFRD SLICED PEPPERONI','F-FL NAT OJ 89FO 6443','DR PEPPER FRIG PK','1 LTR BT POLAR DT TON','GARELICK TRUMOO 1% CHOC MILK','F-BYET TOMATOES 28Z 199','CILANTRO 60 CT','F-BETTY CRCKER CAKE MIX 1207','F-BB SOLID TUNA WTR 5Z 301','SJ ORIGINAL STICK GIANT SIZE','CHRO CEREAL YELLOW BOX','TOSTITOS MILD SALSA','LAND O LAKES AMERICAN WHITE','B YET TOWL ULT SAS 2P 1RL 84CT','MAR SLICED PEPPERONI','F-BUDDIG LNCH MT TUB 193','NAB OREO ORIGINAL FAMILY SIZE','BEVAN MACARONI  CHS FAMSZ','F-CONTADINA TOM PASTE 6Z 631','CHERRY PEPSI 2 LITER','F-GM NV Protein Bars','PERO SNPD GRN BEANS','NEWSPAPERS - DAILY','JFFY CORN MUFFIN MIX','BP HD BEEF FRANKS 8CT','REESE FAST BREAK STANDARD BAR','ONION SUB ROLLS 6 PK','FRITOS SCOOPS','PORK RIBS BONELESS CNTRY STYLE','PLNVL FRM NAT GRND TRKY 94','ORG VLY HALF  HALF','F-Best Yet Cheese Slices 16oz','F-NEWMAN OWN SALSA 16Z 190','F-PRINCE LARGE PASTA 483','SPC WRLD GARLIC SLEEVED','PSZ TOSTITOS RSTC','DIET PEPSI 24PK','HEIDELBERG CRKD WHEAT','HLMN REAL MAYONNAISE','OM FC BACON','F-BETTER THAN BOUILLON BROTH 8OZ','1 LITER POLAR TONIC','F-HOOD SOUR CREAM 8oz 5791','DORITOS NACHO','THAT S SMART BATH TISSUE 4R','M THRU F NY POST','NEWSPAPER (DAILY)','SPRITE 6PK 500 ML BOTTLES','PREMIUM SWEET POTATO','F-PREMIO PATTIES 16OZ 9167','BUTTERMILK BISCUITS 5 PK','F-BYET CRANBERRY SAUCE 14OZ 885','F-8''OCLOCK COFFEE GRND 32','XXL RUFFLES REGULAR','PEARS DANJOU LG EURO (K)','F-PENN DTCH NOODLES 12Z 485','UTZ FRENCH ONION WAVY CHIP','BF TOP SIR STK BNLS USDA CHOIC','LAYS XL CHEDDAR  SOUR CREAM','F-Family group 5710','RED BULL ORIG ENERGY DRNK 12OZ','SMART ABF BNLS SKINLESS BREAST','F-HDDN VLLY DRY MIXES 1Z 540','SARA LEE ARTESANO SAUSAGE ROLL','F-RAOS PASTA SAUCE 6-12OZ','HFMN NC GERM FRK G/F','KRFT JTPF MARSHMALLOWS','AH BAKING SODA','UTZ SALT VINEGAR CHIP','CHICKEN TENDERS HOT','FRNCH YELLOW MUSTARD SQZE','HAMBURGER ROLLS 8 PACK','BELG GRATED PARM CUPS','F-SHED CNTRY CRCK 45OZ 2302','CHERRY OTV','F-ALEXIA POTATOES','BEST YET 31/40 CKD SHRIMP PD','F-STFR 8 OZ BOWL','BUFFALO WINGS HONEY SWEET','TRIN VLY CRMLINE CHOC MLK PINT','ROTEL DICED TOM W GRN CHILI','F-XOCHITL CHIPS 12OZ','PERRI HOT LINKS 13102','F-Family group 6912','BF STRP STEAK BNLS BP CHOICE','DIET PEPSI MAX 2 LITER','F-GREEN GIANT CANNED VEG 33','F-HOOD EGG NOG 1605','GAR DAIRY PURE HVY CREAM PINT','UTZ FRIED DILL PICKLE RIPPLE','RIVER RT PLAIN CHEESE CURDS','B YET OYSTER CRACKERS','B YET VEGETABLE OIL','P5 CHICKEN DRUMSTICKS','B YET STUFFED MANZ OLIVES','GARLIC BREAD SEEDED IN FOIL','F-BYET MOZZERELLA 16OZ','B YET BTH TIS 1PLY 1000SHT 1RL','F-9 LIVES 4 PACK','BP HD BEEF FRANK BUN SIZE 8CT','F-Family Group 1423','F-KRAFT SAUCES 395','OB PIZZA DOUGH','F-DH CLASSIC CAKE MIXES 2239','F-GRN GIANT VEG BOXED 328','F-Family Group 1466','F-Family Group 1738','B YET PIE CRUST','F-Family group 6394','SGRDLE EX THCK BACON-1 LB','F-TYSON NAE CHICKEN','TRIPLE CHOCOLATE COOKIE JUMBO','F-Family group 6281','F-BYET RECLOSEABLE BAGS 904','F-Family group 6324','LIL DEB HONEY BUNS MULTIPK','BEEF LOIN PORTERHOUSE STK TAILLESS C','F-KELL EGGO WAFFLES FAMILY 664','CHRO HONEY NUT CEREAL FAMSZ','DIET PEPSI WILD CHERRY 6PK','F-MINUTE RICE 14Z 534','TOSTITOS MED SALSA','F-GERBER 1ST 2ND NAT FOODS 470','G&G MCKENZIE RBEEF','BE MSH POTAT SNGL PK','F-Family Group 2069','HUNT KETCHUP','HANS KISSLE AGEAN GREEK PASTA','F-PREGO SAUCE 45Z 317','RED BARON CLASSIC PEPPERONI','GR SWT ONION PERUVIAN BIN','RED BARON CLASSIC SUPREME','F-Family group 6298','SMALL FRUIT CUP PINEAPPLE','BF STRIP STK BNLS USDA CHOICE','F-Family group 6010','LETTUCE RED LEAF SLV SFM','ROCKSTAR PUNCHED 16Z','F-BANQUET BOWLS','F-BAYS ENGLISH MUFFINS 4506','F-PHILLY CRM CHS 16OZ 1375','BASILIO BREAKFAST SAUSAGE','93% GROUND BEEF (1.00# NET)','BCKR PREMIUM MULTIGRAIN','BH LONDON BROIL','SQUASH YELLOW 22 LB','F-RONZONI LARGE PASTA 484','ENF GENTLEASE PWDR','FKELL EGGOS-TSTR STCKS 658','P5 PORK BNLS SIRLOIN CHOPS','THOMAS ORIG WHT/HONEY WHEAT MU','P5 REDI-SERVE CHKN NUGGETS','F-RANA TORTELLONI DELI 20Z 4652','F-SIMPLY ORNG 89FO 6444','DIET MOUNTAIN DEW 20Z BOTTLE','F-Family Group 1844','F-BYET OJ 64FO 1307','BTRFNG ORIGINAL BAR SINGLE','WONDER FRANKFURT ROLLS','F-Family group 6710','F-Family Group 2205','F-Family Group 1394','CABBAGE RED','F-BRDEN CHSE SINGLES 12OZ 6501','B YET DESIGNER BOWL 20OZ','BF CHUCK STEAK BNLS USDA CHOIC','PEPSI 1.25LTR','F-ORG VALLEY MILK 64FO 6537','P5 BEEF CHUCK TENDER STEAK','F-Family Group 1446','GG DW BLACK FOREST HAM','STROEH/RANCH WHITE BREAD','FRNCH CLASSIC YELLOW MSTRD','CHICKEN SPLIT BREAST','F-MCCADAM BAR CHS 8OZ 777','F-JIFFY MUFFIN MIXES 381','F-TALENTI GELATO 16FO 1213','F-GOLDS HORSERADISH 1162','FLUFF ORIGINAL PLASTIC','GRADE A LARGE EGGS','PORK CHOPS BONELESS CC BP','POLAR DIET TONIC W/LIME 1LTR','TRIN VLY CRMLINE CHOC MLK 1/2G','F-NEWMANS OWN PASTA SCE 24Z 158','HBO ALMOND CEREAL','MISSION 415 FL SF TACO TORT','F-BQT KID CUISINE MEALS 75','F-HEALTHY CHCE POWER BOWLS','B YET PROVOLONE CHSE SHINGLE','MARTIN POTATO LONG R','F-Group 1782','DIET MT DEW 2 LITER','F-ALM BRZ CRMR 32Z','F-Family Group 1809','F-ITHACA HUMMUS','HD LIGHT CREAM','B YET EVAPORATED MILK','LAYS PARTY BBQ','B YET HALF  HALF','F-PERDUE CHICKEN BREAST 26OZ','SARA LEE BP EVERYTHING ROLLS','STROEH/KING SQARE WHITE BREAD','B YET BATH TIS 2PLY DBL RL 4RL','THOMAS NY STYLE BLUEBRY BAGEL','BAR S MEAT FRANKS CK PORK','CONCORD LEMON JUICE','HEIDELBERG MULTI GRAIN BREAD','YAMS LOUISIANA','1 LITER POLAR CLUB','KH BUTTER SAVORY ROLLS','C/F DIET PEPSI 2LTR','F-MISSION WRAP 15 OZ 732194','COOPERS SHARP AMERICAN WHT','F-4C BREAD CRUMBS 8-15Z 400','F-JELLO GELATIN LARGE 422','PARSLEY PLAIN (ITALIAN) 60 CT','LAYS XL HONEY BBQ CHIPS','F-CAMPBELL GRAVIES 10.5Z 80','F-HUNTS SAUCE 8Z 200','MISSION 419 BURRITO TORT','F-TIDY CAT JUGS 20LB 506','F-JONES SAUS LINKS 3','F-Family group 6590','F-BYET GRK YGRT 32OZ 1385','F-PROGSSO BEANS 19Z 382','FRITOS PARTY SCOOPS','POPCORNRS WHT CHDR CHIPS','B YET BROCCOLI FLORETS','F-Family Group 366','HTFLD MAPLE HAM STEAK','F-FF CAT FOOD 6070','GRMT BURGER PR RIB PATTY 47012','SILVER FLOSS SAUERKRAUT','F-REDI-SRV CHK CL BAG','F-HATFIELD BACON 16Z 96185','POWERADE ZERO MXD BRY','SCOTT TWL WHT MEGA RL CAS 6PK','CELERY 30 CT SLVED','HBO HONEY ROASTED CEREAL','F-Family group 5903','B YET STRING CHEESE 24CT','F-BUDGET SAVER POPS 42.3FO 3725','F-Celebrity Goat Logs 4 oz','F-BYET OATMEAL 42Z 864','F-BYET SALTINES 16OZ 299','F-Family Group 1644','TOSTITOS QUESO BLANCO DIP','GARELICK UHT HALFHALF CREAMER','PFARM ONION SANDWICH BUNS','P5 PORK SHOULDER STEAKS','GARELICK TRUMOO 1%CHOC MILK','B YET TOWEL 2PLY 1RL 48SH','B YET REAL WHIP TOP AERO','CDRY ZERO SUGAR GINGERALE 2LTR','F-Family group 6176','PORK CHOPS BONELESS SIRLOIN','DAILY NEWSPAPER   MON-FRI','F-GLBNI RICOTTA 32Z 6522','PTEGRY MED BRW EGG','ANZIO HRTY SAND ROLLS 8CT','B YET BLACK BEANS','F-JHNVLLE Grnd Sausage 7007 16z','F-GORTONS FISH 11Z 703','RESCUED 4 PK PEPPERS','F-Family Group 841','DORITOS COOL RANCH','SQUASH SPAGHETTI','F-ZATARAINS RICE 40','BEST YET 1893 PROVOLONE','F-SWANSON BROTH 14.5FO 73','APPLE PINK LADY 100 CT','F-Group 17823','F-HF LITTLE FRANKS 31135','CHAB CLASSIC BAGUETTE','MUG ROOT BEER 2LTR','MT DEW CODE RED 2 LITER','CAPN C CRUNCHBERRY CEREAL','MOUNTAIN DEW CODE RED','LIPTON PURE LEAF RASP TEA','POPCORNRS KETTLE CORN CHIPS','BF CUBE STK BP USDA CHOIC','MARTINS POTATO BREAD','DW WHITE AMERICAN CHEESE','F-BIRDS EYE VOILA DINNERS 21Z 244','F-HERSHEY STAND UP BAGS','F-BLUE WD DOG','P5 BEEF TENDERETTES','RUFFLES CHEDDAR SR CREAM','POLAR BLACK CHERRY SELTZER 12P','F-DOM BROWN-CONF SUGAR 16Z BOX 621','F-BYET RELISH 8Z 872','F-SUNNY D PUNCH 128FO 313','F-FRANKS SAUCE 12FO 5851','BYET GRADE A JUMBO BROWN','1 LTR BT POLAR LIME T','BELG MOZZARELLA BALL','SCHW RASP GINGER ALE 2LTR','B YET DESIGNER PLATE 7IN','F-HORMEL DINNERS 10Z 524','F-Family group 6057','PORK CHOPS ASSORTED','F-GLBNI MOZZ 16OZ 6521','MARG STICK PEPPERONI 8 OZ','BUD LT 12OZ/12PK CANS','F-SIMPLY POTATOES 20 OZ 6540','GRADE A LARGE 18PK EGGS','SPARKLING ICE BLACK RASPBERRY','POWERADE GRAPE','F-JT CK EGG SCRAMBLE']
    # item_codes_list = [93148,8981434,8979901,51000000000000,8981153,8981342,94110,8979914,8719,94194,94180,8981286,8981618,8981322,91908,8981461,8981158,5100000000000,94299,8980252,8981459,71330601380,94240,8980831,42187500409,93172,94024,93738,8980350,8981078,8981754,8981479,93944,8981435,9391,93400,8980122,8980102,42187011370,8981166,94016,71330601342,8981341,8980259,8981326,8981442,8981886,8980382,8980023,95882,94389,8979976,8980397,94174,8981759,94066,8981287,8981321,87457,12000504051,8981630,42187220178,8980383,462550,94000,8979710,8981380,93878,447384,8981347,8980000,42200000000,8980833,8981915,8981094,8979973,12000001291,94206,8979945,250214,8981470,8980026,8980396,42187011417,12000000000,8980112,12000001314,8981519,28400199148,50400739420,94068,94500,8981906,8981622,8980024,94020,8979952,8981378,8980367,8980035,49000000443,589359,8979972,8980640,12000504082,93176,8979709,8981054,8979871,42187271460,8981264,270406,28400000000,8981610,8981154,93250,50400751163,94094,71025617160,8981569,28400516464,8981375,94001,8980131,28400310468,517375,8980706,72945612419,72945611900,94102,8979960,12000171956,8980964,8981292,8980145,8981368,8980774,8981488,8725,75457125002,8981912,99991,734497,8980844,8981177,8981345,8981527,8979872,8980180,8980671,48121253196,14998,8981036,8980211,78000082401,8979876,8981756,8981313,72250011372,28888,8632,8981748,8980980,8979769,8981437,8980111,13753,8981463,8981718,8980951,8980214,8980127,8981360,93945,72945601369,12398,46214,12000002335,8981785,8981041,12000809941,41780272096,8981155,94146,8981077,8981621,8980366,8981649,49000007640,8981411,8981436,79875,8981869,0,12000172526,8981619,8980116,12000171741,8980130,72250021098,98033,8980742,8981786,8979820,8980318,72030011080,71025615517,8981747,8980983,8979799,8745,72945601345,12000000171,94004,8981178,8980684,12000001598,8981664,8981779,42187011394,8980002,39423,42187203621,28400083140,8980193,8980942,8980212,8981107,8981266,49000050103,94308,8980104,93966,8981344,8980108,8981367,8981755,8981783,8980886,8979823,8981092,50400739482,8981533,8981641,8981100,8980308,49000028904,29893,93020,28400200608,8982094,8981414,8981520,8981588,8980682,116982,8981106,2693,8981625,8981914,78000152401,8980839,94112,8981514,8980137,59962,93700,72250021081,8981780,8981907,49000024685,8980031,8980369,71025615548,254539,8981605,8981168,96630,8980938,8981398,8979711,48121138066,111497,12000809965,8980835,8980374,28400199636,49000009774,8980639,8981381,8980714,8980315,72945601338,8981608,234196,2190,94270,8980301,28400516310,28400517775,24300041303,8980940,8981801,48121249038,8980913,8981879,8981272,8981217,8981469,495536,287752,78000152463,8980840,8980688,8981160,8979849,42187500331,8980183,8979816,9963,41780272065,8981878,8981556,8981098,8981919,8980982,8979778,8980841,8981456,5356,8980149,8980907,8981464,70847811169,48121292089,83406,287747,8981138,49000040869,78000206463,8981455,8981454,12000000881,91575,8979877,8980906,86783,28400070980,8980978,8980025,8981052,13386,8980704,8981793,93956,8981757,8980375,8980120,28400200592,8981868,8981670,8979846,8981526,3038,93619,8980673,8980812,8981486,8980036,270111,41780271877,8979992,87273,48121184117,8981427,8980022,8981223,8981760,78000003963,8981379,8980670,8981713,8979906,8980378,8980121,8979839,42187503493,8981416,8980124,8980918,94398,8980875,8981467,35681,8979813,8980715,8980905,28400199612,90948,170147,94620,8981924,8979984,63818,8979974,48121229030,8981185,8981307,8979811,28400516679,8981792,8981650,8981099,87745,93699,8981531,41900074968,8981509,8981767,8981495,287750,45166,28400517737,8980903,8980659,72250037068,8981639,8979910,8981192,8980153,8981709,8981706,12000031960,8981440,8981849,49000050158,8981737,8981871,8980313,8979809,8981086,72030013879,204820,8980138,8980916,206121,8980128,8979947,94537,8980150,12000811197,8980920,8980181,49000024692,52013,94482,72250049191,8981259,41780271761,72250011396,8981376,93163,423434,8979847,8981815,8980769,93165,8981640,72945612815,167918,218798,579217,28400705769,12000002946,28400043793,8981019,70847012474,8980832,8980945,78000001174,72945611030,72945705449,90926,8981428,8979818,72250037129,44000069230,44000004637,8981606,44000050986,1472,8979919,72180637178,78000152166,8980003,94003,8981082,8980379,121402,8979994,8980203,8981671,12000811425,69978,74343,33689,49000028911,8981159,8979840,8979802,8981654,8979850,421313,14100070931,49000055375,8979987,8981452,8980806,8981377,270470,75185000039,73410013854,33589123266,8981800,8980287,8981218,44000033255,8981179,8979920,8981025,98950,8981744,8982067,28400323826,49000050110,8981424,8981895,223300,75667,8980917,466152,72030001616,820631,72180637185,8980194,14100071617,8979782,8981115,78000082463,8980989,8981312,8980634,28400201285,8979954,14100071877,8980985,12000171864,8980249,8456,287748,93446,8981346,78000003864,8979887,8979768,8980636,251787,8980357,8981719,79070,12000002977,33589010368,7088,9974,8981246,8981426,8982056,12000018800,8981443,8979800,18200250132,49000028928,94528,12000107351,8980546,8982092,8979975,8980642,94368,78000013252,8981603,8980691,4800,49000079357,8981788,8981438,16033,8981778,8980680,12000172328,47500004459,8981528,78000082166,71537020694,41900072841,8980209,91945,8979812,8980904,234466,587437,28400055970,210389,89277,8980368,44000033279,269356,8980201,12000003110,8980975,826269,754000000000,51616,97418,304308,28400589321,204606,7681,8981412,8981093,8981161,233962,28400517843,12000171857,31711000218,47965,15740,8980473,71537020120,8981612,28400325059,86708,91925960111,718000000000,49000024708,95575,8980309,8980946,8980713,28400516686,98125,8981163,41780271747,28400199988,8980850,611000000000,8979979,72945612877,8981994,236591,317293,45348,41780271839,55853,323953,8981536,592187,8981887,5773,8981752,863000000000,14348,8982036,87752,8980889,22339,12000018817,8980764,8981567,75457783004,41780271709,828000000000,149,33580,15273,8981390,204679,8979900,105631,8980707,8980001,74526000035,8979814,8981909,8981183,8980040,20202,8981765,78671,8980326,8980139,8980926,8980202,24300041020,8981724,307526,12000172397,8979963,28400055987,8979774,871820,8981291,246555,8980030,72180634733,6358,72180634719,8980038,8981117,93971,818000000000,8981776,8981315,8981382,286881,579218,94516,8981162,50827,8981721,48121181048,8981230,8981529,12000001345,8981289,8981524,188061,72250083966,8980957,8981167,8980294,93882,8981413,18221,12000140921,8981573,8979888,71673001120,39965,8981343,8979806,8980247,8981491,27676,48713000030,71537020670,8980028,282043,3626,8981749,8981789,550466,75185000015,8981632,12000007460,8981477,8979902,8981224,2700,29588,28400310406,5825,8980323,50400740419,71673001113,28970,200432,48121255046,97743,95218,31711000454,94038,71537020045,76643,12000172137,8981254,8979886,8980965,90025,28400200684,8980979,8980206,3610,8980649,8980333,313283,8980825,8981636,8979870,28400314039,513997,33200,8980159,256823,8979907,573403,77125,8980327,8980352,49000079326,16873,94247,282304,8980161,256092,8980273,8981203,8980663,8980768,8980039,28400215732,75457427007,14100070986,41900072957,724646,186365,78000148466,8979966,748000000000,8981431,31899,71025615555,393591,8980307,8981799,8980928,28400325042,94540,8979959,8980114,93143,8980390,8980381,23574,12000009358,12000105425,75383,12000002243,12000286223,513992,75185007007,8981753,8981277,8980847,28400324427,71537002287,8980182,8979955,8981513,8980016,9981,71537020366,89990,78000215465,28898,8980834,8981174,8981394,238328,77647,18200530470,8981484,48713000184,16571910303,49000079401,8981584,49000079319,8981140,8981661,8981121,8980141,8979916,34246,428503,1104,8980911,8981727,8981096,8980392,137117,68903,8981881,8980129,8980700,8980778,8981097,8979771,8981139,13037,8981076,8981356,72030014210,75767002017,8980871,613000000000,29603,49000079388,78000206401,151174,17984,8979874,8980067,8980400,95047,8981867,78908222367,78000206166,34112,90047,464816,17320,8979905,79246,32932,8981015,8980948,79074,48121229054,8981142,8979866,422865,8980210,336725,68523,24300043208,8981447,28400067409,333837,452809,49000045840,8980110,93194,8980669,85060,62752,24300041563,8980427,78000207460,8980853,8981181,93708,92724,98206,8980147,33690,8979825,49000079364,8981043,69531,32498,63307,72030022390,8979997,94289,8980342,1841,8980207,181436,8980248,8980719,28400201292,8979788,8980534,8981449,498739,72030014753,8980045,24300044311,8979736,77717,2695,8980921,8980341,24300041280,12585,320474,287755,26832100602,8980785,25624,8979789,8980436,73410138250,49000050141,70199,469565,73410000267,28119,24485]

    names_list = data['Description'].unique()
    if 'Retailer Item Code' in data.columns:
        item_codes_list = data['Retailer Item Code'].unique()
    else:
        item_codes_list = data['Retailer \nItem \nCode'].unique()
     
    names_list = [item for item in names_list if item != "nan"]
    item_codes_list = [item for item in item_codes_list if item != "nan"]
     
    names_list.pop()
    item_codes_list.pop()
    # print(data)
    # print(product_name)
    # print(data.loc[data['Description'].isin({product_name})])
    # if data[data['Description'].isin([product_name])].shape[0] > 0:
    #     responses = (data.loc[data['Description'].isin({product_name})])[['A1 Item Description','Visits(Base Item and A1 Purchased)#','Visits(Base Item and A1 Purchased)%']]
    #     responses = responses.rename(columns={"A1 Item Description": "data","Visits(Base Item and A1 Purchased)#":"Visits #","Visits(Base Item and A1 Purchased)%":"Visits %"})
    if(is_number(product_name) == False):
        altered_list = [re.sub(r'\s+', ' ', name).lower() for name in names_list]
        alias = re.sub(r'\s\s+', ' ', re.sub(r'[^a-zA-Z0-9]', ' ', product_name)).lower().strip()
        
        if((extractOne(alias,altered_list,scorer = QRatio,score_cutoff = 60) is None) == False):
            closest = extractOne(alias,
                                 altered_list,
                                 scorer = QRatio,
                                 score_cutoff = 60)[0].upper()
            responses = (data.loc[data['Description'].isin({closest})])[['A1 Item Description','Visits(Base Item and A1 Purchased)#','Visits(Base Item and A1 Purchased)%']]
        else:
            names_list = data['TITLE'].unique()
            names_list = [item for item in names_list if item != "nan"]
            names_list = names_list = names_list[1:]
            altered_list = [re.sub(r'\s+', ' ', name).lower() for name in names_list]
            closest = max(altered_list, key=lambda paragraph: len(set(paragraph.split()) & set(alias.split())))
            data['UPDATED_DESCRIPTION'] = data['TITLE'].apply(lambda x: clean_name(x) if not pd.isna(x) else x)
            item_name = (data.loc[data['UPDATED_DESCRIPTION'].isin({closest})])[['Description']]
            check_list = item_name['Description'].unique()
            if((extractOne(alias,check_list,scorer = QRatio,score_cutoff = 30) is None) == False):
                  responses = (data.loc[data['UPDATED_DESCRIPTION'].isin({closest})])[['A1 Item Description','Visits(Base Item and A1 Purchased)#','Visits(Base Item and A1 Purchased)%']]
            
        responses = responses.rename(columns={"A1 Item Description": "data","Visits(Base Item and A1 Purchased)#":"Visits #","Visits(Base Item and A1 Purchased)%":"Visits %"})
    else:
      temp_name = float(product_name)
      temp_name = int(temp_name)
      if 'Retailer Item Code' in data.columns:
          data["Retailer Item Code"] = data["Retailer Item Code"].astype(int)
          # if data[data['Retailer \nItem \nCode'].isin([temp_name])].shape[0] > 0:
          responses = (data.loc[data['Retailer Item Code'].isin({temp_name})])[['A1 Item Description','Visits(Base Item and A1 Purchased)#','Visits(Base Item and A1 Purchased)%','Description']]
          responses = responses.rename(columns={"Description":"Base Item","A1 Item Description": "data","Visits(Base Item and A1 Purchased)#":"Visits #","Visits(Base Item and A1 Purchased)%":"Visits %"})
      else:
          data["Retailer \nItem \nCode"] = data["Retailer \nItem \nCode"].astype(int)
          # if data[data['Retailer \nItem \nCode'].isin([temp_name])].shape[0] > 0:
          responses = (data.loc[data['Retailer \nItem \nCode'].isin({temp_name})])[['A1 Item Description','Visits(Base Item and A1 Purchased)#','Visits(Base Item and A1 Purchased)%','Description']]
          responses = responses.rename(columns={"Description":"Base Item","A1 Item Description": "data","Visits(Base Item and A1 Purchased)#":"Visits #","Visits(Base Item and A1 Purchased)%":"Visits %"})

    #start = time.time()
    # for l in loc:
    #     for z in loc[l]:
    #         for p in prods:
    #             if p > 1:
    #                 for w in prods[p]:  
    #                     temp = prod_hier(product_id = w, product_level = p, detail_level = 1, active = active)
    #                     if p >= 2:
    #                         response = requests.post(data_url + '/movement/get-movement-data',
    #                                                  json = {"locationLevelId": l,      
    #                                                          "locationId": z, 
    #                                                          "startDate": cal['start-date'].min().strftime('%m/%d/%Y'), 
    #                                                          "endDate": cal['end-date'].max().strftime('%m/%d/%Y'),   
    #                                                          "calType": "W",            
    #                                                          "fiscalOrAdCalendar": "B",
    #                                                          "productId":w,
    #                                                          "productLevelId":int(p)})
    #                     elif p == 1.5:
    #                         response = requests.post(data_url + '/movement/get-movement-data',
    #                                                  json = {"locationLevelId": l,      
    #                                                          "locationId": z, 
    #                                                          "startDate": cal['start-date'].min().strftime('%m/%d/%Y'), 
    #                                                          "endDate": cal['end-date'].max().strftime('%m/%d/%Y'),   
    #                                                          "calType": "W",            
    #                                                          "fiscalOrAdCalendar": "B",
    #                                                          "itemCodes":[int(x) for x in temp['item-code']]})
    #                     response = pd.DataFrame(response.json())
    #                     response = response.rename(columns = {'itemCode':'item-code'})
    #                     response = temp.loc[:, ['item-name', 'item-code']].merge(response, how = 'inner', on = 'item-code')
    #             elif p == 1:
    #                 temp = prod_hier(product_id = prods[p], product_level = p, detail_level = 1, active = active)
    #                 response = requests.post(data_url + '/movement/get-movement-data',
    #                                          json = {"locationLevelId": l,      
    #                                                  "locationId": z, 
    #                                                  "startDate": cal['start-date'].min().strftime('%m/%d/%Y'), 
    #                                                  "endDate": cal['end-date'].max().strftime('%m/%d/%Y'),   
    #                                                  "calType": "W",            
    #                                                  "fiscalOrAdCalendar": "B",
    #                                                  "itemCodes":[int(x) for x in temp['item-code']]})
    #                 response = pd.DataFrame(response.json())
    #                 response = response.rename(columns = {'itemCode':'item-code'})
    #                 response = temp.loc[:, ['item-name', 'item-code']].merge(response, how = 'inner', on = 'item-code')

    #             responses.append(response)
    # response = pd.concat(responses, ignore_index = True)
    #end = time.time()
    #print('Time taken: {} seconds'.format(round(end - start, 2)))
    
    # if promoted == 'All':
    #     response['movement'] = response['totalMovement']
    #     response['sales'] = response['totalRevenue']
    #     response['margin'] = response['totalMargin']
    # if promoted == 'Yes':
    #     response['movement'] = response['saleMovement']
    #     response['sales'] = response['saleRevenue']
    #     response['margin'] = response['saleMargin']
    # if promoted == 'No':
    #     response['movement'] = response['regMovement']
    #     response['sales'] = response['regRevenue']
    #     response['margin'] = response['regMargin']
    
    # response = response.rename(columns = {'calendarId':'calendar-id',
    #                                       'startDate':'week-start-date',
    #                                       'endDate':'week-end-date',
    #                                       'totalVisits':'visits'})
    # response = response.loc[response['calendar-id'].isin(cal['calendar-id'])]
    # response = response.loc[:, ['week-start-date', 'week-end-date', 'item-name', 'movement',
    #                             'sales', 'margin', 'visits']] 
    # print(os.getcwd())
    # data = pd.read_csv("E:/Users/Ashutosh/iux-agent-main_work/langchain/FeederFile.csv")
    
    response = responses
    #print(response)
    #return response, prod_names, loc_names, cal['start-date'].min().strftime('%m/%d/%Y') + ' - ' + cal['end-date'].max().strftime('%m/%d/%Y')
    #return pd.DataFrame(response,columns = ['data'])
    return pd.DataFrame(response)
    #return response
# =============================================================================
# 
# =============================================================================

def hier_api(product_name = None, product_id = None, product_level = None, detail_level = None,
             other_levels = [5, 4, 3, 2, 1.5, 1], active = 'Y'):
    
    return prod_hier(product_name = product_name, product_id = product_id, product_level = product_level,
                     detail_level = detail_level, other_levels = other_levels, active = active)